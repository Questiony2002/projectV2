<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="800" height="650" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <style>
    @font-face {
      font-family: "SimSun";
      src: local("SimSun");
    }
    @font-face {
      font-family: "Times New Roman";
      src: local("Times New Roman");
    }
    .title {
      font-family: "SimSun", serif;
      font-size: 16px;
      font-weight: bold;
      text-anchor: middle;
    }
    .class-title {
      font-family: "SimSun", serif;
      font-size: 14px;
      font-weight: bold;
      text-anchor: middle;
    }
    .class-text {
      font-family: "SimSun", serif;
      font-size: 12px;
      text-anchor: start;
    }
    .method-text {
      font-family: "SimSun", serif;
      font-size: 12px;
      text-anchor: start;
    }
    .relationship-text {
      font-family: "SimSun", serif;
      font-size: 11px;
      text-anchor: middle;
    }
    .class-box {
      fill: #ffffff;
      stroke: #000000;
      stroke-width: 1.5;
    }
    .entity-class {
      fill: #fff;
      stroke: #000;
      stroke-width: 1.5;
    }
    .controller-class {
      fill: #fff;
      stroke: #000;
      stroke-width: 1.5;
    }
    .service-class {
      fill: #fff;
      stroke: #000;
      stroke-width: 1.5;
    }
    .dto-class {
      fill: #fff;
      stroke: #000;
      stroke-width: 1.5;
    }
    .other-class {
      fill: #fff;
      stroke: #000;
      stroke-width: 1.5;
    }
    .line {
      stroke: #000000;
      stroke-width: 1.5;
      fill: none;
    }
    .dashed-line {
      stroke: #000000;
      stroke-width: 1.5;
      fill: none;
      stroke-dasharray: 5,3;
    }
    .arrow {
      fill: #000000;
    }
    .diamond {
      fill: white;
      stroke: #000000;
      stroke-width: 1.5;
    }
  </style>
  
  <rect width="100%" height="100%" fill="white" />
  
  <!-- User实体类 -->
  <rect x="50" y="60" width="200" height="180" rx="5" ry="5" class="entity-class" />
  <line x1="50" y1="85" x2="250" y2="85" class="line" />
  <line x1="50" y1="170" x2="250" y2="170" class="line" />
  <text x="150" y="75" class="class-title">User</text>
  <text x="60" y="100" class="class-text">- id: Long</text>
  <text x="60" y="115" class="class-text">- username: String</text>
  <text x="60" y="130" class="class-text">- password: String</text>
  <text x="60" y="145" class="class-text">- email: String</text>
  <text x="60" y="160" class="class-text">- phone: String</text>
  <text x="60" y="185" class="method-text">+ getters/setters</text>
  <text x="60" y="200" class="method-text">+ onCreate(): void</text>
  <text x="60" y="215" class="method-text">+ onUpdate(): void</text>
  
  <!-- UserDTO类 -->
  <rect x="50" y="330" width="200" height="150" rx="5" ry="5" class="dto-class" />
  <line x1="50" y1="355" x2="250" y2="355" class="line" />
  <line x1="50" y1="425" x2="250" y2="425" class="line" />
  <text x="150" y="345" class="class-title">UserDTO</text>
  <text x="60" y="370" class="class-text">- id: Long</text>
  <text x="60" y="385" class="class-text">- username: String</text>
  <text x="60" y="400" class="class-text">- email: String</text>
  <text x="60" y="415" class="class-text">- token: String</text>
  <text x="60" y="440" class="method-text">+ getters/setters</text>
  <text x="60" y="455" class="method-text">+ UserDTO()</text>
  <text x="60" y="470" class="method-text">+ UserDTO(User, String)</text>
  
  <!-- UserController类 -->
  <rect x="300" y="60" width="240" height="140" rx="5" ry="5" class="controller-class" />
  <line x1="300" y1="85" x2="540" y2="85" class="line" />
  <line x1="300" y1="110" x2="540" y2="110" class="line" />
  <text x="420" y="75" class="class-title">UserController</text>
  <text x="310" y="100" class="class-text">- userService: UserService</text>
  <text x="310" y="125" class="method-text">+ register(User): ResponseEntity&lt;?&gt;</text>
  <text x="310" y="140" class="method-text">+ login(User): ResponseEntity&lt;UserDTO&gt;</text>
  <text x="310" y="155" class="method-text">+ getUserInfo(Long): ResponseEntity&lt;UserDTO&gt;</text>
  <text x="310" y="170" class="method-text">+ updateUserField(Long, Map): ResponseEntity&lt;UserDTO&gt;</text>
  <text x="310" y="185" class="method-text">+ updatePassword(Long, Map): ResponseEntity&lt;Void&gt;</text>
  
  <!-- UserService接口 -->
  <rect x="300" y="250" width="240" height="110" rx="5" ry="5" class="service-class" />
  <line x1="300" y1="275" x2="540" y2="275" class="line" />
  <line x1="300" y1="295" x2="540" y2="295" class="line" />
  <text x="420" y="265" class="class-title">UserService</text>
  <text x="310" y="290" class="class-text">(interface)</text>
  <text x="310" y="310" class="method-text">+ register(User): UserDTO</text>
  <text x="310" y="325" class="method-text">+ login(String, String): UserDTO</text>
  <text x="310" y="340" class="method-text">+ getUserInfo(Long): UserDTO</text>
  <text x="310" y="355" class="method-text">+ updateUserField(Long, Map): UserDTO</text>
  
  <!-- UserServiceImpl类 -->
  <rect x="300" y="410" width="240" height="160" rx="5" ry="5" class="service-class" />
  <line x1="300" y1="435" x2="540" y2="435" class="line" />
  <line x1="300" y1="485" x2="540" y2="485" class="line" />
  <text x="420" y="425" class="class-title">UserServiceImpl</text>
  <text x="310" y="450" class="class-text">- userRepository: UserRepository</text>
  <text x="310" y="465" class="class-text">- passwordEncoder: PasswordEncoder</text>
  <text x="310" y="480" class="class-text">- jwtTokenUtil: JwtTokenUtil</text>
  <text x="310" y="500" class="method-text">+ (implements all UserService methods)</text>
  <text x="310" y="515" class="method-text">+ loadUserByUsername(String): UserDetails</text>
  <text x="310" y="530" class="method-text">+ convertToDTO(User, String): UserDTO</text>
  <text x="310" y="545" class="method-text">+ validateUser(String, String): User</text>
  <text x="310" y="560" class="method-text">+ hashPassword(String): String</text>
  
  <!-- UserRepository接口 -->
  <rect x="590" y="410" width="200" height="150" rx="5" ry="5" class="other-class" />
  <line x1="590" y1="435" x2="790" y2="435" class="line" />
  <line x1="590" y1="455" x2="790" y2="455" class="line" />
  <text x="690" y="425" class="class-title">UserRepository</text>
  <text x="600" y="450" class="class-text">(extends JpaRepository)</text>
  <text x="600" y="470" class="method-text">+ findByUsername(String): Optional&lt;User&gt;</text>
  <text x="600" y="485" class="method-text">+ findByEmail(String): Optional&lt;User&gt;</text>
  <text x="600" y="500" class="method-text">+ findByPhone(String): Optional&lt;User&gt;</text>
  <text x="600" y="515" class="method-text">+ existsByUsername(String): boolean</text>
  <text x="600" y="530" class="method-text">+ existsByEmail(String): boolean</text>
  <text x="600" y="545" class="method-text">+ existsByPhone(String): boolean</text>
  
  <!-- JwtTokenUtil类 -->
  <rect x="590" y="60" width="200" height="130" rx="5" ry="5" class="other-class" />
  <line x1="590" y1="85" x2="790" y2="85" class="line" />
  <line x1="590" y1="130" x2="790" y2="130" class="line" />
  <text x="690" y="75" class="class-title">JwtTokenUtil</text>
  <text x="600" y="100" class="class-text">- secret: String</text>
  <text x="600" y="115" class="class-text">- expiration: Long</text>
  <text x="600" y="145" class="method-text">+ generateToken(UserDetails): String</text>
  <text x="600" y="160" class="method-text">+ validateToken(String, UserDetails): Boolean</text>
  <text x="600" y="175" class="method-text">+ extractUsername(String): String</text>
  
  <!-- 类之间的关系 - 调整连接线避免交叉 -->
  <!-- Controller使用Service -->
  <path d="M420,200 L420,250" stroke="#000" stroke-width="1.5" marker-end="url(#uses)" fill="none"/>
  <text x="440" y="225" class="relationship-text">Uses</text>
  
  <!-- ServiceImpl实现Service接口 -->
  <path d="M420,360 L420,410" stroke="#000" stroke-width="1.5" marker-end="url(#implements)" fill="none"/>
  <text x="440" y="385" class="relationship-text">Implements</text>
  
  <!-- ServiceImpl使用Repository -->
  <path d="M540,485 L590,485" stroke="#000" stroke-width="1.5" marker-end="url(#uses)" fill="none"/>
  <text x="565" y="470" class="relationship-text">Uses</text>
  
  <!-- ServiceImpl使用JwtTokenUtil -->
  <path d="M420,410 L420,380 L530,380 L530,280 L690,280 L690,190" stroke="#000" stroke-width="1.5" marker-end="url(#uses)" fill="none"/>
  <text x="550" y="360" class="relationship-text">Uses</text>
  
  <!-- User与UserDTO的关系 -->
  <path d="M150,240 L150,330" stroke="#000" stroke-width="1.5" marker-end="url(#transforms)" fill="none"/>
  <text x="170" y="290" class="relationship-text">Transforms</text>
  
  <!-- ServiceImpl操作User实体 -->
  <path d="M300,450 L280,450 L280,150 L250,150" stroke="#000" stroke-width="1.5" marker-end="url(#uses)" fill="none"/>
  <text x="260" y="300" class="relationship-text">Operates</text>
  
  <defs>
    <marker id="implements" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto">
      <polygon points="0,0 10,5 0,10" fill="white" stroke="#000" stroke-width="1"/>
    </marker>
    <marker id="uses" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto">
      <polygon points="0,0 10,5 0,10" fill="#000"/>
    </marker>
    <marker id="transforms" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto">
      <polygon points="0,0 10,5 0,10" fill="#000"/>
    </marker>
  </defs>
</svg> 